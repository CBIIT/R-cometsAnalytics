library(COMETS)
install.packages("xlsx")
library(COMETS)
excorrdata  <- COMETS::stratCorr(modeldata,metabdata,cohort="",stratvar)
csvfile <- "C:/Users/bsc-default/Documents/Comets/Testing files/cometsInput_alt4.xlsx"
exmetabdata <- COMETS::readCOMETSinput(csvfile)
exmodeldata <- COMETS::getModelData(exmetabdata,modbatch="1.1 Unadjusted")
stratCorr<- function(modeldata,metabdata,cohort=""){
# start the clock
ptm <- proc.time() # start processing time
# initialize to avoid globalv errors
stratlist=holdmod=holdcorr=scorr=NULL
stratlist <- unique(modeldata$gdta[modeldata$scovs])
for (i in seq(along=stratlist[,1])) {
holdmod <- modeldata
holdmod[[1]] <- dplyr::filter_(modeldata$gdta,paste(modeldata$scovs," == ",stratlist[i,1])) %>%
select(-dplyr::one_of(modeldata$scovs))
holdcorr  <- COMETS::getCorr(holdmod,metabdata,cohort=cohort)
holdcorr$stratavar<-as.character(modeldata$scovs)
holdcorr$strata<-stratlist[i,1]
scorr<-dplyr::bind_rows(scorr,holdcorr)
}
# Stop the clock
ptm <- proc.time() - ptm
attr(scorr,"ptime") = paste("Processing time:",round(ptm[3],digits=6),"sec")
return(scorr)
}
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
library(tidyverse)
stratCorr<- function(modeldata,metabdata,cohort=""){
# start the clock
ptm <- proc.time() # start processing time
# initialize to avoid globalv errors
stratlist=holdmod=holdcorr=scorr=NULL
stratlist <- unique(modeldata$gdta[modeldata$scovs])
for (i in seq(along=stratlist[,1])) {
holdmod <- modeldata
holdmod[[1]] <- dplyr::filter_(modeldata$gdta,paste(modeldata$scovs," == ",stratlist[i,1])) %>%
select(-dplyr::one_of(modeldata$scovs))
holdcorr  <- COMETS::getCorr(holdmod,metabdata,cohort=cohort)
holdcorr$stratavar<-as.character(modeldata$scovs)
holdcorr$strata<-stratlist[i,1]
scorr<-dplyr::bind_rows(scorr,holdcorr)
}
# Stop the clock
ptm <- proc.time() - ptm
attr(scorr,"ptime") = paste("Processing time:",round(ptm[3],digits=6),"sec")
return(scorr)
}
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
exmodeldata <- COMETS::getModelData(exmetabdata,modelspec="Interactive",
colvars="entry_age bmi_curr")
excorrdata  <- COMETS::getCorr(exmodeldata,exmetabdata,"TWINSUK")
exmodeldata <- COMETS::getModelData(exmetabdata,modelspec="Interactive",
colvars="entry_age bmi_curr",strvars = "center")
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
exmodeldata <- COMETS::getModelData(exmetabdata,modelspec="Interactive",
colvars="entry_age bmi_curr",strvars = "center")
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
View(exscorr)
exmodeldata <- COMETS::getModelData(exmetabdata,modelspec="Interactive",
colvars="entry_age bmi_curr",adjvars="cmpf",strvars = "center")
exmodeldata <- COMETS::getModelData(exmetabdata,modelspec="Interactive",
colvars="entry_age",adjvars="bmi_curr",strvars = "center")
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
exmodeldata <- COMETS::getModelData(exmetabdata,modelspec="Interactive",
colvars="entry_age",adjvars="bmi_curr")
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
exmodeldata <- COMETS::getModelData(exmetabdata,modelspec="Interactive",
colvars="entry_age",adjvars="bmi_curr")
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
q()
csvfile <- "C:/Users/bsc-default/Documents/Comets/Testing files/cometsInput_alt4.xlsx"
exmetabdata <- COMETS::readCOMETSinput(csvfile)
exmodeldata <- COMETS::getModelData(exmetabdata,modbatch="1.1 Unadjusted")
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
library(tidyverse)
exscorr<-stratCorr(exmodeldata,exmetabdata,"TWINSUK")
View(exscorr)
View(exscorr)
available.packages()
chkp<-available.packages()
View(chkp)
install.packages("rJava")
install.packages("xlsxjars")
View(chkp)
document()
devtools::document()
library("xlsx", lib.loc="~/R/win-library/3.3")
install.packages("xlsx")
